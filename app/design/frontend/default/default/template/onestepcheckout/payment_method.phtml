<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_default
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * One page checkout payment methods
 *
 * @see Mage_Checkout_Block_Onepage_Payment_Methods
 */
?>
<?php

$helper = Mage::helper('onestepcheckout/checkout');
$hide_nonfree_methods = false;
if($helper->settings['hide_nonfree_payment_methods'])   {
    foreach($this->getMethods() as $_method)    {
        if($_method->getCode() == 'free')   {
            $hide_nonfree_methods = true;
        }
    }
}


?>

<div class="payment-methods">

<script type="text/javascript">
//<![CDATA[
  <?php echo $this->getChildHtml('reward.scripts'); ?>
  <?php echo $this->getChildHtml('customerbalance_scripts'); ?>
  var payment = new Payment('checkout-payment-method-load', '<?php echo $this->getUrl('checkout/onepage/savePayment') ?>');
//]]>
</script>
    <?php if(str_replace('.', '', Mage::getVersion()) > 1600):?>
        <?php echo $this->getChildHtml('customerbalance'); ?>
        <?php echo $this->getChildHtml('reward.points'); ?>
    <?php endif;?>   
    <?php /*?>
    <dl id="checkout-payment-method-load">
    <?php foreach ($this->getMethods() as $_method): $_code = $_method->getCode() ?>
    <?php if($hide_nonfree_methods && $_code != 'free') continue; ?>
        <dt>
        <?php if( sizeof($this->getMethods()) > 1 ): ?>
            <input id="p_method_<?php echo $_code ?>" value="<?php echo $_code ?>" type="radio" name="payment[method]" title="<?php echo $this->htmlEscape($_method->getTitle()) ?>" class="radio" <?php if($this->getSelectedMethodCode()==$_code || ($hide_nonfree_methods && $_code == 'free')): ?> checked="checked"<?php endif; ?> />
        <?php else: ?>
            <span class="no-display"><input id="p_method_<?php echo $_code ?>" value="<?php echo $_code ?>" type="radio" name="payment[method]" checked="checked" /></span>
        <?php endif; ?>
            <label for="p_method_<?php echo $_code ?>"><?php echo $_method->getTitle() ?></label>
        </dt>
        <?php if($html = $this->getChildHtml('payment.method.'.$_code)): ?>
        <dd id="container_payment_method_<?php echo $_code; ?>" class="payment-method">
            <?php echo $html; ?>
        </dd>
        <?php endif; ?>
    <?php endforeach; ?>
    </dl>     <?php */?>
    <div>



<div id="choose_bank" class="choose">
	<li >
		<input type="radio"  title="支付宝" name="payment[method]" value="alipay_payment" id="p_method_alipay_payment" class="payment_alipay">
		<label for="p_method_alipay_payment"><img src="<?php echo $this->getSkinUrl()?>images/bank_zfb.jpg" title="支付宝" alt="支付宝"></label> 
	</li>

	<div style="display:none;">
		<input type="radio"  title="财付通" name="payment[method]" value="tenpay_payment" id="p_method_tenpay_payment">
		
	</div>
  		<li >
		<input type="radio"  title="财付通" name="payment[bank_type]" value="0" id="p_method_tenpay_payment_ten" class="payment">
		<label for="p_method_tenpay_payment_ten"><img src="<?php echo $this->getSkinUrl()?>images/bank_cft.jpg" title="财付通" alt="财付通"></label>  
		</li>
    
    <li>
        <input type="radio" class="radio" title="盛付通" name="payment[method]" value="shengpay_payment" id="p_method_shengpay_payment">
        <label for="p_method_shengpay_payment"><img src="<?php echo $this->getSkinUrl()?>images/shengpay.jpg" title="盛付通" alt="盛付通"></label>
    </li>
    
    <li>
        <input type="radio" class="radio" title="Paypal" name="payment[method]" value="paypals_payment" id="p_method_paypals_payment">
        <label for="p_method_paypals_payment"><img src="<?php echo $this->getSkinUrl()?>images/visamaster.jpg" title="Paypal" alt="Paypal"></label>
    </li>
  
		<li >
		<input type="radio"  title="招商银行" name="payment[bank_type]" value="1001" id="p_method_tenpay_payment_CMB" class="payment">
		<label for="p_method_tenpay_payment_CMB"><img src="<?php echo $this->getSkinUrl()?>images/CMB.jpg" title="招商银行" alt="招商银行"></label> 
	</li>
  		<li >
		<input type="radio"  title="工商银行" name="payment[bank_type]" value="1002" id="p_method_tenpay_payment_ICBC" class="payment">
		<label for="p_method_tenpay_payment_ICBC"><img src="<?php echo $this->getSkinUrl()?>images/ICBC.jpg" title="工商银行" alt="工商银行"></label> 
	</li>
   		<li >
		<input type="radio"  title="建设银行" name="payment[bank_type]" value="1003" id="p_method_tenpay_payment_CCB" class="payment">
		<label for="p_method_tenpay_payment_CCB"><img src="<?php echo $this->getSkinUrl()?>images/CCB.jpg" title="建设银行" alt="建设银行"></label> 
		</li>
     		<li >
		<input type="radio"  title="农业银行" name="payment[bank_type]" value="1005" id="p_method_tenpay_payment_ABC" class="payment">
		<label for="p_method_tenpay_payment_ABC"><img src="<?php echo $this->getSkinUrl()?>images/ABC.jpg" title="农业银行" alt="农业银行"></label> 
		</li>
  

  
         		<li >
		<input type="radio"  title="交通银行" name="payment[bank_type]" value="1020" id="p_method_tenpay_payment_BCOM" class="payment">
		<label for="p_method_tenpay_payment_BCOM"><img src="<?php echo $this->getSkinUrl()?>images/BCOM.jpg" title="交通银行" alt="交通银行"></label> 
	</li>
  
           		<li >
		<input type="radio"  title="光大银行" name="payment[bank_type]" value="1022" id="p_method_tenpay_payment_CEB" class="payment">
		<label for="p_method_tenpay_payment_CEB"><img src="<?php echo $this->getSkinUrl()?>images/CEB.jpg" title="光大银行" alt="光大银行"></label> 
	</li>
  
             <li >
		<input type="radio"  title="浦发银行" name="payment[bank_type]" value="1004" id="p_method_tenpay_payment_SPDB" class="payment">
		<label for="p_method_tenpay_payment_SPDB"><img src="<?php echo $this->getSkinUrl()?>images/SPDB.jpg" title="浦发银行" alt="浦发银行"></label> 
	</li>
  
               	<li >
		<input type="radio"  title="民生银行" name="payment[bank_type]" value="1006" id="p_method_tenpay_payment_CMBC" class="payment">
		<label for="p_method_tenpay_payment_CMBC"><img src="<?php echo $this->getSkinUrl()?>images/CMBC.jpg" title="民生银行" alt="民生银行"></label> 
		</li>
  

	<div class="clear"></div>
</div>
<div class="line"></div>
</div>
</div>
<script type="text/javascript">
jQuery(function(){

jQuery(".payment").click(function(){
	jQuery("#p_method_tenpay_payment").attr("checked",true);
  jQuery("#p_method_tenpay_payment").click();
});
jQuery("#p_method_alipay_payment").click(function(){
	jQuery(".payment").attr("checked",false);
});
jQuery("#p_method_shengpay_payment").click(function(){
	jQuery(".payment").attr("checked",false);
});
jQuery("#p_method_paypals_payment").click(function(){
	jQuery(".payment").attr("checked",false);
});

});
</script>
<script type="text/javascript">
//<![CDATA[
var checkout = new Checkout();
$$('#checkout-payment-method-load dt input').invoke('observe', 'click', function(e) {

    var element = e.element();
    var name = 'payment_form_' + element.getValue();
    payment.currentMethod = element.getValue();
    /* Hide all other forms */
    $$('dd.payment-method').invoke('hide');

    if(element.checked) {
        var form = $(name);
        var container = $('container_payment_method_' + element.getValue());

        if(element !== null && container !== null)    {
            container.show();
            $(name).show();
        }
    }
});

<?php if(Mage::helper('onestepcheckout')->isEnterprise() && Mage::helper('customer')->isLoggedIn()):?>
//if we have a enterprise version we should include this

rPoints = $('use_reward_points');
if(rPoints){
    if(rPoints.checked){
        payment.switchRewardPointsCheckbox();
    }
}
cBalance = $('use_customer_balance');
if(cBalance){
    if(cBalance.checked){
        payment.switchCustomerBalanceCheckbox();
    }
}
//if we have a enterprise version we should include this end
<?php endif;?>

payment.currentMethod = "<?php echo $this->getQuote()->getPayment()->getMethod() ?>";
//]]>
</script>